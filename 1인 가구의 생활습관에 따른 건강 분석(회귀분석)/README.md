## 1. 배경 & 목적

---

- 회귀분석 수업 기말 프로젝트

## 2. 주최 & 참가 대상 & 성과

---

- 주최: 국민대학교 회귀분석 수업
- 참가대상: 회귀분석 수업 수강생
- 성과: A+

## 3. 프로젝트 기간(대회 기간)

---

- 제출마감: 2023년 7월 10일
- 1차 서류심사: 2023년 7월 12일~14일
- 2차 발표평가: 2023년 7월 31일

## 4. 내용

---

# 1. **서론**

## 1.1 **요약**

국민건강영양조사 자료를 바탕으로 연구를 진행하였다. 원본 자료에서 관심 있는 변수들만 추출한 후 모름과 무응답은 결측지로 모두 제거한 후 회귀분석을 진행하였다. 1인 가구의 생활 습관과 건강과의 상관관계를 확인 후 1인 가구 건강에 대한 기초자료를 제공하자 한다.

## 1.2 **연구 배경**

1인 가구란 “가구원이 한 명인 가구로, 2000년대 이후 결혼 시기가 늦춰지고 미혼율 및 이혼율 증가와 함께 사회가 고령화되면서 그 비중이 높아지고 있다.” 통계청의 인구총조사에 따르면 “2000년도 15.5%에서 2005년도에 20%로, 2010년에는 23.9%, 2015년 27.2%”로 지속해서 증가하고 있으며 현재는 31.7%로 높은 비율을 차지하고 있다. 1인 가구들은 건강에 관한 관심이 적은 편이며 식사가 규칙적이지 못하고 건강한 생활 습관을 가지지 못한다고 알려져 있다. 또한 외식과 배달ㆍ테이크아웃의 이용률이 높으므로 고나트륨ㆍ고지방ㆍ고열량의 음식을 섭취 비율이 높으며 안 좋은 식습관을 가지곤 한다. 1인 가구들은 본인의 학업이나 직장 때문에 1인 가구가 되는 경우가 많으므로 다른 연령대에 비해서 본인의 건강을 살피는데 여유가 없다고 한다.

현재 필자 또한 기숙사에 거주하며 1인 가구의 형태를 취하고 있는데 건강한 음식을 챙겨 먹는 것은 쉽지 않은 게 현실이다. 생활습관이 나빠지면서 체력이 안좋아지는 것을 느끼게 되었고 다른 1인가구의 생활 습관과 건강에 대해 알아보고자 하는 취지에서 연구 주제를 정하게 되었다.

## 1.3 **연구 목표**

국민건강영양조사 데이터를 분석함으로써 1인 가구의 생활습관을 알아본 후 이들의 건강과 어떤 관련이 있는지 파악해볼 것이다. 1인 가구 생활 습관과 건강에 대한 분석을 통해서  1인 가구의 건강에 대한 자료를 제공하고자 한다.

# **2. 본론**

## 2.1 **연구 내용**

통계프로그램인 R의 dplyr, leaps, MASS 등을 이용했고 국민건강영양조사 자료를 전처리한 후 회귀모형을 만들어보았다. 1인 가구 형태인 사람을 대상으로 정하였다. 그 모름, 무응답은 결측치로 제거하며 데이터 전처리를 진행해 준 결과 최초 표본이었던 8,110명에서 676명으로 감소하였고 이들을 분석대상자로 정했다.

건강을 나타내는 건강 관련 삶의 질을 반응변수로 두고 생활 습관과 관련한 변수들을 설명변수로 정하였다. 반응변수와 설명변수의 관계, 즉 건강과 생활 습관의 상관관계를 나타내는 회귀모형을 만들어보았다. 최종으로 완성된 회귀모형을 점검하고 생활습관과 관련해서 실제로 1인 가구의 건강이 관련이 있는지 확인하고 어떠한 의미를 나타내는지 파악하며 결론을 내렸다.

## 2.2 **연구 도구**

### **2.2.1 반응 변수 및 설명 변수**

반응변수로는 EQ5D(건강관련 삶의 질)을 사용하였다. 이는 Euro-Qol group에서 제작한 EQ-5D를 활용한 것으로, 국민건강영양조사에서 2005년부터 사용하기 시작하였다. EQ5D는 1.운동능력 수준, 2.자기관리 수준, 3.일상활동 수준, 4.통증, 불편감 수준, 5.불안, 우울 수준으로 구성되어 있고 1=문제 없음, 2=다소 문제 있음, 3=심각한 문제 있음의 3가지 수준으로 나타난다.

![1인가구_1](https://github.com/Gayeon6423/Project/assets/113704015/919be22b-02d4-423f-9672-056119b85b07)

건강관련 삶의 질 지수는 건강상태를 EQ-5D지수의 5가지 영역의 3가지 수준(3^5 =243)으로 나타낸다. 이렇게 얻어진 건강상태에 가중치를 곱해서 계산하며 –1점과 +1점 사이에 분포되어 있다. EQ5D의 값이 1에 가까울수록 건강상태가 좋은 것으로 본다.

![1인가구_2](https://github.com/Gayeon6423/Project/assets/113704015/74cdc733-4e94-499a-ad9a-e62fd7e8d8ee)

설명변수로는 L_OUT_FQ(외식 횟수), BS3_1(현재흡연 여부), BP1(평소 스트레스 인지 정도), BP16_1((만12세이상)주중(또는 일하는 날)하루 평균 수면 시간), BP16_2 ((만12세이상) 주말(또는 일하지 않는 날, 일하지 않는 전날) 하루 평균 수면 시간), LF_S4(식비가 부족하여 균형잡힌 식사를 할 수 없던 경험), DI1_2(혈압조절제 복용), DI2_2(이상지질혈증 약복용), DJ4_3(천식 약복용(소아, 청소년 포함)), BE3_31(1주일간 걷기 일수) 을 사용하였다.

### **2.2.2 분석 방법**

통계 프로그램인 R을 이용해서 탐색적 분석을 한 후 회귀모형을 검정하는 순으로 분석을 진행하였다. 변수선택 기준으로 수정된 결정계수, Mallows – Cp, PRESS, AIC, BIC을 사용한 후 예비모형을 구축하였다. 부분F검정, 편회귀그림, 적합결여검정, 변수변환을 통해 회귀모형을 진단하고 수정하였다. 탐색적 분석을 바탕으로 핵심적인 설명변수와 회귀모형을 선정한 후 표준화 회귀계수, 다중공선성 탐색을 통해서 회귀진단을 실시하며 최종모형을 결정하였다.

## 2.3 **탐색적 분석**

### 2.3.1 **변수선택 기준**

중회귀모형: 𝑌𝑖 = 𝛽0 + 𝛽1𝑋𝑖1 +𝛽2𝑋𝑖2 + 𝛽3𝑋𝑖3 +𝛽4𝑋𝑖4 + ⋯ + +𝛽10𝑋𝑖10 +𝜖𝑖, 𝑖 = 1,2, … ,676

𝑌𝑖: i번째 조사대상자의 건강관련 삶의 질 지수

𝑋𝑖1: i번째 조사대상자의 외식횟수

𝑋𝑖2: i번째 조사대상자의 현재흡연 여부

𝑋𝑖3: i번째 조사대상자의 평소 스트레스 인지 정도

𝑋𝑖4: i번째 조사대상자의 주중(또는 일하는 날) 하루 평균 수면 시간

𝑋𝑖5: i번째 조사대상자의 주말(또는 일하지 않는 날, 일하지 않는 전날) 하루 평균 수면 시간

𝑋𝑖6: : i번째 조사대상자의 식비가 부족하여 균형잡힌 식사를 할 수 없던 경험

𝑋𝑖7: i번째 조사대상자의 혈압조절제 복용

𝑋𝑖8: i번째 조사대상자의 이상지질혈증 약복용

𝑋𝑖9: i번째 조사대상자의 천식 약복용(소아, 청소년 포함)

𝑋𝑖10: i번째 조사대상자의 1주일간 걷기 일수

[추정회귀계수]

![1인가구_3](https://github.com/Gayeon6423/Project/assets/113704015/59f89621-bee2-47fe-a94c-1552fb36941c)

모든 변수를 포함한 중회귀모형의 추정회귀계수를 구해보았다. p_value값을 확인해보았을 때 L_OUT_FQ(X1), BS3_1(X2), BP1(X3), LF_S4 (X6), DI2_2(X8), BE3_31(X10)변수가 유의수준 5%보다 작으므로 유의하고 BP16_1(X4), BP16_2(X5), DI1_2 (X7), DJ4_3(X9)변수가 유의하지 않은 것으로 생각된다.

[수정된 결정계수 adj_R]

수정된 결정계수는 71번째 모형에서 가장 큰 값이 도출되었고 null model과 비교했을 때 p_value가 유의수준 0.05보다 작으므로 귀무가설을 기각했다.

이때의 최종모형은 𝑌𝑖=𝛽0+𝛽1𝑋𝑖1+𝛽2𝑋𝑖2+𝛽3𝑋𝑖3+𝛽5𝑋𝑖5+𝛽6𝑋𝑖6+ 𝛽8𝑋𝑖8+ 𝛽9𝑋𝑖9+𝛽10𝑋𝑖10 +𝜖𝑖이다.

![1인가구_4](https://github.com/Gayeon6423/Project/assets/113704015/55947377-495d-41b9-a7f2-a21d070bd9e6)

[Mallows-Cp]

Mallows-Cp는 51번째 모형에서 가장 작은 값이 도출되었고 null model과 비교했을 때 p_value가 유의수준 0.05보다 작으므로 귀무가설을 기각했다.

이때의 최종모형은 𝑌𝑖=𝛽0+𝛽1𝑋𝑖1+𝛽2𝑋𝑖2+𝛽3𝑋𝑖3+𝛽6𝑋𝑖6+ 𝛽8𝑋𝑖8+ 𝛽10𝛽10𝑋𝑖10 +𝜖𝑖이다.

![1인가구_5](https://github.com/Gayeon6423/Project/assets/113704015/ccf599bc-89da-4f9d-9d88-32bfb2bbc664)

[BIC]

BIC는 51번째 모형에서 가장 작은 값이 도출되었고 null model과 비교했을 때 p_value가 유의수준 0.05보다 작으므로 귀무가설을 기각했다.

이때의 최종모형은 𝑌𝑖=𝛽0+𝛽1𝑋𝑖1+𝛽2𝑋𝑖2+𝛽3𝑋𝑖3+𝛽6𝑋𝑖6+ 𝛽8𝑋𝑖8+ 𝛽10𝛽10𝑋𝑖10 +𝜖𝑖이다.

부분F검정, 수정된 결정계수, Mallows-Cp, BIC를 종합한 결과 X1, X2, X3, X6, X8, X10변수가 모형에 적합하다고 판단하였다.

![1인가구_6](https://github.com/Gayeon6423/Project/assets/113704015/851d8106-92c7-472d-a1d7-9c66f85be44e)

### 2.3.2 **변수선택 방법**

[단계별 회귀]

![1인가구_7](https://github.com/Gayeon6423/Project/assets/113704015/9ff9521b-edda-40c2-8abc-d11fc2ba0a81)

[전진선택법]

![1인가구_8](https://github.com/Gayeon6423/Project/assets/113704015/34b927fe-57fe-4963-8e0b-865b8850c4da)

[후진제거법]

![1인가구_9](https://github.com/Gayeon6423/Project/assets/113704015/3c0c34d1-f23c-4f4a-a054-044028309939)

세가지 경우 모두 X1, X2, X3, X6, X7, X10변수가 모형에 적합하다는 결과가 나왔다.

### 2.3.3 **회귀모형 진단 및 수정**

[부분F검정]

1. 변수선택기준 결과를 바탕으로 Reduced_model1에서는 X4, X5, X7, X9 변수에 대해서 반응변수EQ-5D의 효과가 없다는 가설검정을 부분 F검정으로 살펴보았다.

가설 : 𝐻0 ∶ 𝛽4 = 𝛽5 = 𝛽7 = 𝛽9 = 0 VS 𝐻𝑎 ∶ 𝑛𝑜𝑡 𝐻0

검정결과 p_value가 0.4652로써 유의수준 0.05에서 귀무가설을 기각하지 못했다. 따라서 BP16_1, BP16_2, DI1_2 , DJ4_3를 제외한 설명변수 6개의 축소모형이 10개의 변수를 모두 포함한 Full model보다 더 적절하다고 볼 수 있다.

1. 변수선택방법 결과를 바탕으로 Reduced_model1에서는 X4, X5, X8, X9 변수에 대해서 반응변수EQ-5D의 효과가 없다는 가설검정을 부분 F검정으로 살펴보았다.

가설 : 𝐻0 ∶ 𝛽4 = 𝛽5 = 𝛽8 = 𝛽9 = 0 VS 𝐻𝑎 ∶ 𝑛𝑜𝑡 𝐻0

검정결과 p_value가 0.007652로써 유의수준 0.05보다 작으므로 귀무가설을 기각했었다. X8 대신 X7변수를 Reduced model2에 넣으면 Full model이 적합하다는 결과가 나왔다. 따라서 Reduced model1이 더 적합하다고 가정했고 X1, X2, X3, X6, X8, X10을 적합한 변수라고 판단했다.

[편회귀그림]

X1, X2, X3, X6, X8, X10에 대한 편회귀그림을 그리고 편회귀 기울기를 구해보았다.

![1인가구_10](https://github.com/Gayeon6423/Project/assets/113704015/872a1eea-45f4-4271-b9a2-178e048cb23e)

가장 뚜렷한 선형관계를 보인 변수는 X6이였다. 즉, 순수한 X6의 값이 반응변수 Y에 가장 많은 영향을 주고 있는 것을 확인하였다.

[적합결여검정]

X1, X3, X10의 적합결여검정 결과 귀무가설이 기각되므로 S^2이 과대추정되었다. 따라서 적합하지 않은 변수로 판단하였다.

X2, X6, X8의 적합결여검정 결과 귀무가설이 기각되지않으므로 S^2이 과대추정되지 않았다. 따라서 적합한 변수로 판단하였다.

[변수변환]

X2, X6, X8을 변수로 가진 Reduced3_model을 plot함수로 살펴본 결과 잔차는 중심에 모여있고 Q-Q plot은 완벽한 선형성을 보이지는 않았다. 따라서 변수변환이 필요하다고 판단한 후 √Y 변환을 해주었다.

변수변환 결과 기존의 모형과 큰 차이가 없는 것으로 나타났다. 따라서 변수 변환 전 모형인 Reduced3_model을 최종모형 후보로 정했다.

## 2.4 **회귀 모형 선택**

### 2.4.1 **모형 검정**

[다중공선성 탐색]

다중공선성이란 설명변수들간의 상관관계가 높아 최소제곱추정량의 계산이 불가능해지는 것을 의미한다. 여기서는 VIF값이 5보다 작으므로 다중공선성이 없다.

[영향력 측도]

영향력 측도들을 통해서 이상치를 구해본 결과 6, 22, 25, 29, 65, 82, 84, 100, 103, 104, 107, 109, 138, 157, 159, 162, 169, 170, 172, 174, 179, 192, 201, 238, 251, 252, 299,300, 308, 310, 312, 317, 320, 331, 335, 339, 347, 350, 363, 364, 380, 400, 406, 441, 452, 453, 463, 497, 525, 529, 530, 536, 539, 546, 556, 570, 581, 588, 634, 639, 650, 657, 660이 이상치로 도출되었다.

676개의 행으로 구성되었던 Reduced3_model에서 63개의 이상치를 제외하고 613개의 행으로

구성된 final_model을 최종모형으로 결정하였다.

[더빈-왓슨 검정]

더빈-왓슨 검정통계량이 0~4사이에 있으므로 오차항의 독립을 만족한다.

### 2.4.2 **최종 모형 결정**

훈련자료(70%, 429개)와 확인자료(30%, 184개)로 구분한 후 예측오차를 구하고, PRESS와 R^2pedict를 구해보았다. PRESS와 SSE의 값이 비슷하고 R^2와 R^2predict가 비슷하므로 최종모형은 타당하다고 볼 수 있다.

![1인가구_11](https://github.com/Gayeon6423/Project/assets/113704015/2569bbaf-4e1a-4d32-8b63-b3fabad7fcd6)

최종모형의 설명변수 X2, X6, X8과 반응변수Y의 회귀모형을 그려봤다. 흡연 횟수가 늘어날수록  건강관련 삶의 질 지수가 낮아졌으며 식비가 부족하여 균형잡힌 식사를 할 수 없던 경험이 줄어들수록 건강관련 삶의 질 지수가 높아졌다. 또한 이상지질혈증 약복용 횟수가 줄어들수록 건강관련 삶의 질 지수가 높아지는 것을 확인할 수 있었다.

# 3. **결론**

본 프로젝트를 통해서 1인 가구들의 건강 관련 삶의 질에 영향을 주고 있는 요인들을 파악해보았다. 탐색적 분석 후 최종 회귀모형을 검정한 결과 현재 흡연 여부, 식비가 부족하여 균형잡힌 식사를 할 수 없던 경험, 이상 지지혈증 약 복용이 1인 가구의 건강 관련 삶에 영향을 준다는 것을 확인하였다. 이러한 결과를 바탕으로 1인 가구의 건강에 대한 자료를 제공하였고 1인 가구의 건강 관련 삶의 질을 향상하기 위한 연구가 필요하다고 전하고 싶다.

이번 프로젝트를 진행하면서 아쉬웠던 점은 두 가지 이다. 첫째, 선형성, 독립성, 다중공선성 등을 확인하고 회귀진단을 실시하면서 유의미한 변수들이 감소하게 되었고, 이를 보면서 예비모형을 구축할 때 더욱 많은 설명변수를 관측해야 했음을 느꼈다. 둘째, 최종 회귀모형을 확인해보면 X2 변수와 X8 변수에서 8 비해당 부분에 자료가 많이 몰려있었다. 처음 국민건강영양조사 자료를 봤을 때 비해당 부분 또한 다른 답변과 비슷하게 구성될 것이라 생각해서 하나의 값으로 여기고 결측치 처리를 하지 않았었는데 이 또한 모름, 무응답과 함께 결측치 처리를 해야 했음을 느꼈다. 다음 프로젝트를 진행할 때는 이러한 한계점을 보완하며 더 정확하고 유의미한 회귀모형을 만들 것이다.

# 4. **참고문헌**

서울&, “저소득 가구 여성과 1인 가구, 서울시민 중 가장 건강 취약”, 2022-02-24

김종규,권이승,가천대학교 경상대학 헬스케어경영학과, 연세대학교 보건과학대학, “보건행정학 EQ-5DIndex 이용 성인 암 환자의 인구사회학적 특성별건강관련 삶의 질 측정”

KOSIS, “가구주의 성, 연령 및 세대구성별 가구(일반가구)”

# 5. 증빙자료

- 보고서
        
    [[회귀분석][기말프로젝트][경제학과20200856정가연][보고서]](https://docs.google.com/document/d/1sUL7HYJqhlnc4vlR0iG-OcWACQuVrQnb/edit?usp=sharing&ouid=109060680601725630686&rtpof=true&sd=true)
    
    [[회귀분석][기말프로젝트][경제학과20200856정가연][발표 PDF]](https://drive.google.com/file/d/18rDeLR5wngm1jeB9B9b8WdTs8i2r-gQk/view?usp=sharing)
    

- **코드(R)**
    
    [[회귀분석][기말프로젝트][경제학과20200856정가연][코드]](https://drive.google.com/file/d/18VD_RIhUsXgq0_SaWjnyQTcMXpr-0WG-/view?usp=sharing)
